# Домашнее задание к семинару 03 (HW03)

Тема: мини-приложение на Python для EDA – структура проекта, CLI и расширение функциональности.

## Задание

---

### 2.3. Основное задание: расширение функциональности `eda-cli`

Основная часть HW03 — **инженерная**: вы дорабатываете уже существующий проект.

#### 2.3.1. Новые эвристики качества данных

В модуле `src/eda_cli/core.py` в функции `compute_quality_flags`:

1. Добавьте **не менее двух новых эвристик качества данных**. Примеры (можно выбрать свои, но они должны быть осмысленными):

   - `has_constant_columns` — флаг, показывающий, есть ли колонки, где все значения одинаковые.
   - `has_high_cardinality_categoricals` — флаг, сигнализирующий, что есть категориальные признаки с очень большим числом уникальных значений (нужно определить свой порог).
   - `has_suspicious_id_duplicates` — проверка, что идентификатор (например, `user_id`) уникален; при наличии дубликатов выставлять флаг.
   - `has_many_zero_values` — для числовых колонок проверить долю нулей и выставить флаг, если она превышает выбранный порог.

2. Включите новые флаги в возвращаемый словарь из `compute_quality_flags` так, чтобы ими можно было пользоваться из других частей кода.

3. Убедитесь, что ваши эвристики **корректно работают** хотя бы на `data/example.csv` и на одном дополнительном небольшом датасете (можно использовать учебные данные из HW02 или придумать небольшой CSV самостоятельно).

4. При необходимости скорректируйте расчёт интегрального показателя `quality_score`, чтобы он учитывал новые факторы (это не обязательно, но приветствуется).

---

#### 2.3.2. Новые параметры CLI-команды `report`

В модуле `src/eda_cli/cli.py` доработайте команду `report` так, чтобы она принимала **дополнительные параметры**, влияющие на отчёт. Нужно реализовать:

1. Не менее **двух новых опций командной строки**, например:

   - `--max-hist-columns` – сколько числовых колонок включать в набор гистограмм (по умолчанию можно оставить текущее значение, но дать возможность его изменить).
   - `--top-k-categories` – сколько top-значений выводить для категориальных признаков.
   - `--title` – заголовок отчёта (`# ...` в начале `report.md`).
   - `--min-missing-share` – порог доли пропусков, выше которого колонка считается проблемной и попадает в отдельный список в отчёте.

2. Реально использовать эти параметры внутри функции `report`:

   - передавать значения в функции из `core.py` и `viz.py` (там, где это уместно);
   - включать информацию о новых порогах/настройках в генерируемый `report.md` (например, отдельной строкой в разделе «Качество данных» или в разделах про пропуски/категориальные признаки).

3. Обновить `README.md` проекта или краткий текстовый блок (при его отсутствии можно создать минимальный `README.md`), где описать:

   - какие команды CLI доступны (минимум `overview` и `report`);
   - какие новые параметры добавлены к `report` и как они влияют на отчёт;
   - пример вызова `eda-cli report` с новыми опциями.

---

#### 2.3.3. Минимальные тесты под свои изменения

В файле `tests/test_core.py` добавьте **не менее одного теста**, который проверяет вашу новую логику.

1. Создайте небольшой DataFrame внутри теста, который позволяет проверить хотя бы одну из ваших новых эвристик в `compute_quality_flags`. Например:

   - DataFrame с константной колонкой для проверки `has_constant_columns`;
   - DataFrame с категорией, где очень много уникальных значений, для `has_high_cardinality_categoricals`;
   - DataFrame с дублирующимися идентификаторами для `has_suspicious_id_duplicates`.

2. Напишите тест, который:

   - вызывает `compute_quality_flags` на этом DataFrame;
   - проверяет, что соответствующий флаг принимает ожидаемое значение (`True`/`False`);
   - при необходимости проверяет корректность связанных величин (например, долю нулей или пропусков).

3. Убедитесь, что полный набор тестов проходит без ошибок:

   ```bash
   uv run pytest -q
   ```

---
  - структуры `homeworks/HW03/` с вложенным проектом `eda-cli` (или эквивалентным);
  - внесённых изменений в код (эвристики, параметры CLI, тесты), находящихся в актуальной версии основной ветки (`main` или другой заранее оговорённой).
- Проверка осуществляется через клонирование репозитория преподавателем и запуск указанных в этом документе команд `uv run …` внутри проекта.

---
